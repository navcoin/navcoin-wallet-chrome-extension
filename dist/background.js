let e_message,e_sender,tabId=0;function openPopup(e,t){console.log("Opening popup..."),chrome.windows.getCurrent((function(t){top=0,left=parseInt(t.width-430),chrome.windows.create({url:e,type:"popup",width:430,height:640,left,top,focused:!0}).then((e=>{console.log(e)}))}))}function processExternalMessage(e,t,c){console.log(t),console.log(e),console.log("Sender origin -> "+t.origin),console.log("Sender url -> "+t.url),e_message=e,e_sender=t,tabId=t.tab.id;let n=chrome.runtime.id;console.log("Extension id ->"+n),chrome.tabs.query({},(function(e){for(var t=!0,c=e.length-1;c>=0;c--)if(console.log(e[c].url),e[c].url==="chrome-extension://"+n+"/index.html"||e[c].url==="chrome-extension://"+n+"/index.html#"){t=!1,console.log("window exist"),chrome.runtime.sendMessage({cmd:"update_action",message:e_message,sender:e_sender},(function(e){console.log("response received from existing window"),console.log(e)})),"list_nft_collections"!=e_message.method&&chrome.windows.update(e[c].windowId,{focused:!0});break}if(t)return console.log("window not exist"),this.openPopup("index.html"),!0}))}function checkForError(){const{lastError:e}=chrome.runtime;if(e)return e.stack&&e.message?e:new Error(e.message)}function openTab(e){return new Promise(((t,c)=>{chrome.tabs.create(e).then((e=>{const n=checkForError();return n?c(n):t(e)}))}))}function openExtensionInBrowser(e=null,t=null,c=!1){let n=chrome.runtime.getURL("index.html");e&&(n+=`#${e}`),t&&(n+=`?${t}`),openTab({url:n})}function m_accept_connection(e){accept_connection(e)}function m_reject_connection(){reject_connection()}function m_create_nft_collection(e){create_nft_collection(e)}function m_create_nft(e){create_nft(e)}function m_list_nft_collections(e){list_nft_collections(e)}function m_accept_create_nft_sell_order(e){accept_create_nft_sell_order(e)}function m_reject_create_nft_sell_order(){reject_create_nft_sell_order()}function m_accept_get_nft_sell_order(e){accept_get_nft_sell_order(e)}function m_accept_cancel_nft_order(){accept_cancel_nft_order()}function m_reject_cancel_nft_order(){reject_cancel_nft_order()}function m_accept_create_transaction(e){accept_create_transaction(e)}function m_reject_create_transaction(){reject_create_transaction()}function m_accept_sign_message(e,t){accept_sign_message(e,t)}function m_reject_sign_message(){reject_sign_message()}function m_accept_create_private_token(e){accept_create_private_token(e)}function m_reject_create_private_token(){reject_create_private_token()}function m_accept_mint_private_token(e){accept_mint_private_token(e)}function m_reject_mint_private_token(){reject_mint_private_token()}chrome.runtime.onInstalled.addListener((()=>{console.log("Welcome to Navcoin Wallet")})),chrome.runtime.onMessageExternal.addListener(((e,t,c)=>{})),chrome.runtime.onMessage.addListener((function(e,t,c){console.log(t),console.log(e),"ready"==e.cmd?c({message:e_message,sender:e_sender}):"accept_connection"==e.cmd?(console.log("Accepting connection"),console.log("Sending to tab :"+tabId),c({cmd:e.cmd,result:!0}),chrome.scripting.executeScript({target:{tabId},world:"MAIN",function:m_accept_connection,args:[e.address]})):"reject_connection"==e.cmd?(console.log("Rejecting connection"),console.log("Sending to tab :"+tabId),c({cmd:e.cmd,result:!0}),chrome.scripting.executeScript({target:{tabId},world:"MAIN",function:m_reject_connection})):"accept_create_nft_collection"==e.cmd?(console.log("Accept nft collection"),console.log("Sending to tab :"+tabId),c({cmd:e.cmd,result:!0}),chrome.scripting.executeScript({target:{tabId},world:"MAIN",function:m_create_nft_collection,args:[!0]})):"reject_create_nft_collection"==e.cmd?(console.log("Reject nft collection"),console.log("Sending to tab :"+tabId),c({cmd:e.cmd,result:!0}),chrome.scripting.executeScript({target:{tabId},world:"MAIN",function:m_create_nft_collection,args:[!1]})):"accept_create_nft"==e.cmd?(console.log("Accept create nft"),console.log("Sending to tab :"+tabId),c({cmd:e.cmd,result:!0}),chrome.scripting.executeScript({target:{tabId},world:"MAIN",function:m_create_nft,args:[!0]})):"reject_create_nft"==e.cmd?(console.log("Reject create nft"),console.log("Sending to tab :"+tabId),c({cmd:e.cmd,result:!0}),chrome.scripting.executeScript({target:{tabId},world:"MAIN",function:m_create_nft,args:[!1]})):"list_nft_collections"==e.cmd?(console.log("List nft collections"),console.log("Sending to tab :"+tabId),c({cmd:e.cmd,result:!0}),chrome.scripting.executeScript({target:{tabId},world:"MAIN",function:m_list_nft_collections,args:[e.collections]})):"accept_create_nft_sell_order"==e.cmd?(console.log("Accepting create nft sell order"),console.log("Sending to tab :"+tabId),c({cmd:e.cmd,result:!0}),chrome.scripting.executeScript({target:{tabId},world:"MAIN",function:m_accept_create_nft_sell_order,args:[e.result]})):"reject_create_nft_sell_order"==e.cmd?(console.log("Reject create nft sell order"),console.log("Sending to tab :"+tabId),c({cmd:e.cmd,result:!0}),chrome.scripting.executeScript({target:{tabId},world:"MAIN",function:m_reject_create_nft_sell_order,args:[]})):"accept_get_nft_sell_order"==e.cmd?(console.log("Returning nft sell order"),console.log("Sending to tab :"+tabId),c({cmd:e.cmd,result:!0}),chrome.scripting.executeScript({target:{tabId},world:"MAIN",function:m_accept_get_nft_sell_order,args:[e.order]})):"accept_cancel_nft_order"==e.cmd?(console.log("Accepting cancel nft sell order"),console.log("Sending to tab :"+tabId),c({cmd:e.cmd,result:!0}),chrome.scripting.executeScript({target:{tabId},world:"MAIN",function:m_accept_cancel_nft_order,args:[]})):"reject_cancel_nft_order"==e.cmd?(console.log("Rejecting cancel nft sell order"),console.log("Sending to tab :"+tabId),c({cmd:e.cmd,result:!0}),chrome.scripting.executeScript({target:{tabId},world:"MAIN",function:m_reject_cancel_nft_order,args:[]})):"accept_create_transaction"==e.cmd?(console.log("Accepting create transaction"),console.log("Sending to tab :"+tabId),c({cmd:e.cmd,result:!0}),chrome.scripting.executeScript({target:{tabId},world:"MAIN",function:m_accept_create_transaction,args:[e.tx]})):"reject_create_transaction"==e.cmd?(console.log("Rejecting create transaction"),console.log("Sending to tab :"+tabId),c({cmd:e.cmd,result:!0}),chrome.scripting.executeScript({target:{tabId},world:"MAIN",function:m_reject_create_transaction,args:[]})):"accept_sign_message"==e.cmd?(console.log("Accepting sign message"),console.log("Sending to tab :"+tabId),c({cmd:e.cmd,result:!0}),chrome.scripting.executeScript({target:{tabId},world:"MAIN",function:m_accept_sign_message,args:[e.signed_message,e.address]})):"reject_sign_message"==e.cmd?(console.log("Rejecting sign message"),console.log("Sending to tab :"+tabId),c({cmd:e.cmd,result:!0}),chrome.scripting.executeScript({target:{tabId},world:"MAIN",function:m_reject_sign_message,args:[]})):"accept_create_private_token"==e.cmd?(console.log("Accepting create private token"),console.log("Sending to tab :"+tabId),c({cmd:e.cmd,result:!0}),chrome.scripting.executeScript({target:{tabId},world:"MAIN",function:m_accept_create_private_token,args:[e.tx]})):"reject_create_private_token"==e.cmd?(console.log("Rejecting create private token"),console.log("Sending to tab :"+tabId),c({cmd:e.cmd,result:!0}),chrome.scripting.executeScript({target:{tabId},world:"MAIN",function:m_reject_create_private_token,args:[]})):"accept_mint_private_token"==e.cmd?(console.log("Accepting mint private token"),console.log("Sending to tab :"+tabId),c({cmd:e.cmd,result:!0}),chrome.scripting.executeScript({target:{tabId},world:"MAIN",function:m_accept_mint_private_token,args:[e.tx]})):"reject_mint_private_token"==e.cmd?(console.log("Rejecting mint private token"),console.log("Sending to tab :"+tabId),c({cmd:e.cmd,result:!0}),chrome.scripting.executeScript({target:{tabId},world:"MAIN",function:m_reject_mint_private_token,args:[]})):(console.log("Processing external message"),processExternalMessage(e,t,c),c({method:e.method,result:!0}))})),chrome.runtime.onInstalled.addListener((({reason:e})=>{"install"===e&&openExtensionInBrowser()}));